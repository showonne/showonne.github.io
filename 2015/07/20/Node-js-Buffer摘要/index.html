<!doctype html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hexo</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/tomorrow-night.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
    <header>
    <span class="banner"><a href="/">Hexo</a></span>
    <span class="menu">Menu</span>
    <ul class="menu_list hide">
        
            <li><a href="/">Home</a></li>
        
            <li><a href="/archives">Archives</a></li>
        
            <li><a href="/tags">Tags</a></li>
        
            <li><a href="/links">Links</a></li>
        
            <li><a href="/about">About</a></li>
        
    </ul>
</header>
    <div class="main">
        
    <article>
    <h1 class="post-title">
        <span>Node.js Bufferæ‘˜è¦</span>
    </h1>
    <section class="post-content">
        
            
        
        <p>çº¯JavaScriptå¯¹Unicodeå‹å¥½ä½†æ˜¯æ— æ³•å¾ˆå¥½åœ°å¤„ç†äºŒè¿›åˆ¶æ•°æ®.å½“æˆ‘ä»¬å¤„ç†ç±»ä¼¼TCPæµæˆ–æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæ˜¯éœ€è¦å¤„ç†å…«ä½æµçš„.Nodeæœ‰å‡ ç§æ“ä½œã€åˆ›å»ºä»¥åŠæ¶ˆè´¹(consuming)å…«ä½æµçš„ç­–ç•¥ã€‚</p>
<p>Bufferåƒä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½†å¯¹åº”ç€ V8 å †ä¹‹å¤–çš„ä¸€ä¸ªåŸå§‹å†…å­˜åˆ†é…åŒºåŸŸ.Bufferä¸èƒ½è¢«resize.<br>Bufferç±»æ˜¯ä¸€ä¸ªç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„å…¨å±€ç±»å‹ï¼Œå®ƒå¯ä»¥è¢«å¤šç§æ–¹å¼æ„é€ .<br><a id="more"></a></p>
<h2 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h2><p><strong>new Buffer(size)</strong><br>åˆ†é…ä¸€ä¸ªæ–°çš„ buffer å¤§å°æ˜¯sizeçš„8ä½å­—èŠ‚.<br><strong>new Buffer(array)</strong><br>åˆ†é…ä¸€ä¸ªæ–°çš„ buffer ä½¿ç”¨ä¸€ä¸ª8ä½å­—èŠ‚arrayæ•°ç»„.<br><strong>new buffer(str [,encoding])</strong><br>åˆ†é…ä¸€ä¸ªbufferï¼ŒåŒ…å«ç€æŒ‡å®šçš„strï¼Œé»˜è®¤ç¼–ç utf8</p>
<h2 id="ç±»æ–¹æ³•"><a href="#ç±»æ–¹æ³•" class="headerlink" title="ç±»æ–¹æ³•"></a>ç±»æ–¹æ³•</h2><p><strong>Buffer.byteLength(str, [encoding])</strong><br>å°†ä¼šè¿”å›è¿™ä¸ªå­—ç¬¦ä¸²<code>çœŸå®byteé•¿åº¦</code>,<code>encoding</code>é»˜è®¤<code>utf8</code></p>
<pre><code>console.log(Buffer.byteLength(&quot;å‘µå‘µ&quot;)); //è¿”å›å€¼ä¸º6,å¸¸ç”¨ä¸­æ–‡å­—ç¬¦ç”¨utf-8ç¼–ç å ç”¨3ä¸ªå­—èŠ‚
</code></pre><p><strong>Buffer.concat(list, [totalLength]) </strong><br>è¿”å›ä¸€ä¸ªä¿å­˜ç€å°†ä¼ å…¥bufferæ•°ç»„ä¸­æ‰€æœ‰bufferå¯¹è±¡æ‹¼æ¥åœ¨ä¸€èµ·çš„bufferå¯¹è±¡.listä¸ºç”¨äºè¢«æ‹¼æ¥çš„bufferæ•°ç»„.totalLength:ä¸Šè¿°Bufferæ•°ç»„çš„æ‰€æœ‰Bufferçš„æ€»å¤§å°ã€‚</p>
<pre><code>var buf1 = new Buffer([1,2,3]); 
console.log(buf1);  //&lt;Buffer 01 02 03&gt;
var buf2 = new Buffer([4,5,6]);
console.log(buf2);  //&lt;Buffer 04 05 06&gt;
buf2 = Buffer.concat([buf1,buf2]);
console.log(buf2);  //&lt;Buffer 01 02 03 04 05 06&gt;
</code></pre><h2 id="å®ä¾‹å±æ€§"><a href="#å®ä¾‹å±æ€§" class="headerlink" title="å®ä¾‹å±æ€§"></a>å®ä¾‹å±æ€§</h2><p><strong>buf[index]</strong><br><strong>buf.length</strong> è¿”å›è¿™ä¸ªbufferçš„byteså¤§å°.è¿™æœªå¿…æ˜¯è¿™bufferé‡Œé¢å†…å®¹çš„å¤§å°ï¼Œè€Œæ˜¯ä¾æ®æ˜¯bufferå¯¹è±¡æ‰€åˆ†é…çš„å†…å­˜æ•°å€¼ï¼Œå®ƒä¸ä¼šéšç€è¿™ä¸ªbufferå¯¹è±¡å†…å®¹çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p>
<pre><code>var buf1 = new Buffer(20);
console.log(buf1.length);  //20
</code></pre><h2 id="å®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h2><p><strong>buf.write(str, [offset], [length], [encoding])</strong><br>æŒ‰ç…§æŒ‡å®šå‚æ•°å°†strå†™å…¥bufferï¼Œsträ¸ºæŒ‡è¦å†™å…¥çš„å­—ç¬¦ä¸²ï¼Œoffsetåç§»é‡ï¼Œé»˜è®¤0ï¼Œlengthå†™å…¥é•¿åº¦ï¼Œé»˜è®¤<code>buffer.length-offset</code>ï¼Œencodingé»˜è®¤utf8.è¿”å›å€¼ä¸ºnumberç±»å‹ï¼Œè¡¨ç¤ºå¤šå°‘8ä½å­—èŠ‚æµè¢«å†™å…¥äº†ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šå‡ºç°å†™å…¥éƒ¨åˆ†å­—ç¬¦ã€‚</p>
<pre><code>var buf = new Buffer(10);
var len = buf.write(&quot;ä»Šå¤©å¤©ä¸é”™&quot;);
console.log(len + &quot;bytes:&quot; + buf.toString());//9 bytes:ä»Šå¤©å¤©
</code></pre><p><strong>buf.toString([encoding], [start], [end])</strong>å°†Bufferè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼åˆ†åˆ«ä¸º<code>utf8</code>,<code>0</code>,<code>buffer.length</code></p>
<p><strong>buf.toJSON()</strong> è¿”å›ä¸€ä¸ªJSONè¡¨ç¤ºçš„Bufferå®ä¾‹ã€‚<code>JSON.stringify</code>å°†ä¼šé»˜è®¤è°ƒç”¨æ¥å­—ç¬¦ä¸²åºåˆ—åŒ–è¿™ä¸ªBufferå®ä¾‹ã€‚</p>
<p><strong>buf.slice([start], [end])</strong> è¿”å›ä¸€ä¸ªæ–°çš„bufferï¼Œè¿™ä¸ªbufferå°†ä¼šå’Œè€çš„bufferå¼•ç”¨ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œåªæ˜¯æ ¹æ®start(é»˜è®¤æ˜¯0) å’Œend(é»˜è®¤buffer.length) åç§»å’Œè£å‰ªäº†ç´¢å¼•.</p>
<pre><code>var buf1 = new Buffer(&quot;123&quot;);
console.log(buf1); // &lt;Buffer 31 32 33&gt;
var buf2 = buf1.slice(1,2);
console.log(buf2); // &lt;Buffer 32&gt;
buf2[0] = 0x33;
console.log(buf1); // &lt;Buffer 31 33 33&gt;
</code></pre><p><strong>buf.fill(value, [offset], [end])</strong> ä½¿ç”¨æŒ‡å®šçš„valueæ¥å¡«å……è¿™ä¸ªbufferã€‚</p>
<pre><code>var b = new Buffer(50);b.fill(&quot;h&quot;);
</code></pre>
    </section>
    
        <section id="comments">
        
        </section>
    
</article>

    </div>
    <button class="feedback-btn" data-feedbackok-trigger>Hello~ ğŸ¥°</button>
    <footer>
    <div class="info"><span>Powered By <a href="https://hexo.io/" target="blank">Hexo</a></span>&nbsp;&nbsp;&nbsp;&nbsp;<span>Theme by <a href="https://github.com/showonne/hexo_showonne" target="blank">Showonne</a></span></div>
</footer>
    <script src="https://cdn.feedbackok.com/widget.js" data-pid="0m524p3" async defer></script>
    <script src="/js/index.js"></script>
</body>
</html>
